<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MeteorWatch ‚Ä¢ Next Meteor Shower Countdown</title>
<meta name="description" content="Live countdown to the next meteor shower, with best hemisphere and visibility from your latitude."/>
<style>
  :root{
    --bg:#060912; --card:#0b1020; --edge:#1a2340; --fg:#eaf2ff; --muted:#9fb0cc; --accent:#7cc6ff; --glow:rgba(124,198,255,.25);
    --north:#85f; --south:#5f9; --both:#ffd166;
  }
  html,body{height:100%;margin:0;background:radial-gradient(1200px 600px at 70% 10%, #0a1330 0%, #070b18 60%, var(--bg) 100%);color:var(--fg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:980px;margin:0 auto;padding:20px}
  header{display:flex;align-items:center;justify-content:space-between;margin-top:8px;margin-bottom:16px}
  .brand{font-weight:700;letter-spacing:.3px}
  .badge{color:var(--muted);font-size:13px}
  .card{background:linear-gradient(180deg, rgba(124,198,255,.06), rgba(124,198,255,.02));border:1px solid var(--edge);border-radius:16px;box-shadow:0 0 40px var(--glow) inset; padding:18px}
  h1{font-size:28px;margin:0 0 8px}
  h2{font-size:18px;margin:16px 0 8px;color:var(--muted)}
  .grid{display:grid;gap:16px}
  @media(min-width:900px){ .grid{grid-template-columns: 1.3fr .7fr;} }
  .big{font-weight:700;font-size:40px;letter-spacing:.5px}
  .count{display:flex;gap:10px;flex-wrap:wrap;margin:6px 0 14px}
  .pill{background:rgba(255,255,255,.06); border:1px solid var(--edge); border-radius:12px; padding:8px 10px; min-width:92px; text-align:center}
  .name{font-size:20px}
  .kv{display:grid;grid-template-columns:auto 1fr;gap:6px 10px;color:var(--muted);margin-top:8px}
  .kv b{color:var(--fg)}
  .chip{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--edge);border-radius:999px;padding:6px 10px;margin:10px 0;background:rgba(255,255,255,.05)}
  .chip.north{border-color:var(--north); box-shadow:0 0 0 1px rgba(136,85,255,.2) inset}
  .chip.south{border-color:var(--south); box-shadow:0 0 0 1px rgba(85,255,153,.2) inset}
  .chip.both{border-color:var(--both);  box-shadow:0 0 0 1px rgba(255,209,102,.2) inset}
  .vis-note{font-size:13px;color:var(--muted);margin-top:6px}
  .list .item{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px;border:1px solid var(--edge);border-radius:12px;background:rgba(255,255,255,.04)}
  .list .item .meta{color:var(--muted);font-size:14px}
  footer{color:var(--muted);font-size:13px;margin:18px 0 30px}
  /* canvas backdrop */
  #sky{position:fixed;inset:0;z-index:-1;display:block}
</style>
</head>
<body>
<canvas id="sky"></canvas>

<div class="wrap">
  <header>
    <div class="brand">‚òÑÔ∏è MeteorWatch</div>
    <div class="badge" id="tz"></div>
  </header>

  <div class="grid">
    <section class="card" id="main-card">
      <div class="badge">Next meteor shower</div>
      <h1 id="next-name" class="name">‚Äî</h1>
      <div id="next-when" class="badge">‚Äî</div>

      <div class="chip both" id="hemi-chip">üåç Best hemisphere: <b id="best-hemi">‚Äî</b></div>
      <div class="vis-note" id="vis-note" style="display:none">‚Äî</div>

      <div class="count" id="count">
        <div class="pill"><div class="big" id="d">0</div>days</div>
        <div class="pill"><div class="big" id="h">0</div>hrs</div>
        <div class="pill"><div class="big" id="m">0</div>min</div>
        <div class="pill"><div class="big" id="s">0</div>sec</div>
      </div>

      <div class="kv">
        <div>Radiant:</div> <b id="radiant">‚Äî</b>
        <div>Peak ZHR:</div> <b id="zhr">‚Äî</b>
        <div>Best viewing:</div> <b id="tips">‚Äî</b>
        <div>Hemisphere:</div> <b id="hemi">‚Äî</b>
      </div>
    </section>

    <aside class="card">
      <h2>Upcoming</h2>
      <div id="upcoming" class="list" aria-live="polite"></div>
    </aside>
  </div>

  <footer>
    Data is approximate & displayed in your local time. Visibility depends on latitude, sky darkness, and weather. ‚ú®
  </footer>
</div>

<script>
/* =========================
   1) Event data (UTC ISO + declination)
   Update yearly with real peaks & dec values.
   ========================= */
const SHOWERS = [
  { name:"Orionids",   peak:"2025-10-22T03:00:00Z", zhr:20,  radiant:"Orion (RA 95¬∞, Dec +16¬∞)",  dec: 16, tips:"After midnight; best pre-dawn." },
  { name:"Leonids",    peak:"2025-11-18T04:00:00Z", zhr:15,  radiant:"Leo (RA 152¬∞, Dec +22¬∞)",   dec: 22, tips:"Late night; fast bright meteors." },
  { name:"Geminids",   peak:"2025-12-14T07:00:00Z", zhr:120, radiant:"Gemini (RA 112¬∞, Dec +33¬∞)", dec: 33, tips:"All night; very reliable." },
  { name:"Quadrantids",peak:"2026-01-03T21:00:00Z", zhr:110, radiant:"Bootes (RA 230¬∞, Dec +49¬∞)", dec: 49, tips:"Short, sharp peak; pre-dawn." },
  { name:"Eta Aquariids", peak:"2026-05-06T08:00:00Z", zhr:50, radiant:"Aquarius (RA 338¬∞, Dec ‚àí1¬∞)", dec:-1, tips:"Best just before dawn; southern favoured." },
  { name:"Delta Aquariids", peak:"2026-07-30T02:00:00Z", zhr:25, radiant:"Aquarius (Dec ‚àí16¬∞)", dec:-16, tips:"After midnight; dark skies help a lot." }
];

/* derive best hemisphere label from declination */
function bestHemisphere(dec){
  if (dec > 20) return "North favoured";
  if (dec < -20) return "South favoured";
  return "Both hemispheres";
}
function hemiClass(label){
  if (label.startsWith("North")) return "north";
  if (label.startsWith("South")) return "south";
  return "both";
}

/* pick next upcoming by UTC */
function nextEvent(nowUTC = new Date()){
  return SHOWERS.find(s => new Date(s.peak) > nowUTC) || null;
}

/* pretty date in local tz */
function fmtLocal(iso){
  const d = new Date(iso);
  return d.toLocaleString(undefined, { dateStyle:'medium', timeStyle:'short' });
}

/* countdown diff */
function diffParts(ms){
  const total = Math.max(0, Math.floor(ms/1000));
  const d = Math.floor(total/86400);
  const h = Math.floor((total%86400)/3600);
  const m = Math.floor((total%3600)/60);
  const s = total%60;
  return {d,h,m,s};
}

/* simple max-elevation estimate for user's latitude */
function maxElevation(lat, dec){
  // h_max ‚âà 90¬∞ ‚àí |lat ‚àí dec|
  return 90 - Math.abs(lat - dec);
}
function visibilityNote(lat, dec){
  const h = maxElevation(lat, dec);
  if (h <= 0) return {text:"Radiant does not rise at your latitude ‚Üí not visible.", level:"bad"};
  if (h < 20) return {text:`Low radiant (~${h.toFixed(0)}¬∞ max) ‚Üí fewer meteors visible.`, level:"low"};
  if (h < 40) return {text:`Moderate radiant height (~${h.toFixed(0)}¬∞) ‚Üí decent visibility.`, level:"ok"};
  return {text:`Good radiant height (~${h.toFixed(0)}¬∞) ‚Üí good visibility from your latitude.`, level:"good"};
}

/* mount next + upcoming */
document.getElementById('tz').textContent = `Your timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}`;

const next = nextEvent();
if(next){
  const best = bestHemisphere(next.dec);
  const chip = document.getElementById('hemi-chip');
  chip.className = `chip ${hemiClass(best)}`;
  document.getElementById('best-hemi').textContent = best;

  document.getElementById('next-name').textContent = next.name;
  document.getElementById('next-when').textContent = `Peaks ${fmtLocal(next.peak)} (local time)`;
  document.getElementById('radiant').textContent = next.radiant;
  document.getElementById('zhr').textContent = `~${next.zhr}/hr (ideal, dark sky)`;
  document.getElementById('hemi').textContent = best;
  document.getElementById('tips').textContent = next.tips;

  // countdown
  const dEl = document.getElementById('d');
  const hEl = document.getElementById('h');
  const mEl = document.getElementById('m');
  const sEl = document.getElementById('s');
  function tick(){
    const now = new Date();
    const ms = new Date(next.peak) - now;
    const {d,h,m,s} = diffParts(ms);
    dEl.textContent = d; hEl.textContent = h.toString().padStart(2,'0');
    mEl.textContent = m.toString().padStart(2,'0'); sEl.textContent = s.toString().padStart(2,'0');
    requestAnimationFrame(()=>setTimeout(tick, 250));
  }
  tick();

  // optional: location-aware visibility note
  if ("geolocation" in navigator){
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat = pos.coords.latitude;
      const note = visibilityNote(lat, next.dec);
      const el = document.getElementById('vis-note');
      el.textContent = `From ~${lat.toFixed(1)}¬∞: ${note.text}`;
      el.style.display = 'block';
    }, _err=>{
      // user denied; no problem‚Äîstick with best hemisphere tag only
    }, {timeout:4000});
  }
}

// upcoming list (next 3 after now)
const upcomingEl = document.getElementById('upcoming');
const now = new Date();
const upcoming = SHOWERS.filter(s => new Date(s.peak) > now).slice(0,3);
if (upcoming.length === 0) {
  upcomingEl.innerHTML = `<div class="item"><div>No upcoming events in list.</div></div>`;
} else {
  upcomingEl.innerHTML = upcoming.map(s => {
    const hemi = bestHemisphere(s.dec);
    const emoji = hemi.startsWith('North') ? 'üåè' : hemi.startsWith('South') ? 'üåé' : 'üåç';
    return `
      <div class="item">
        <div>
          <div><b>${s.name}</b></div>
          <div class="meta">${fmtLocal(s.peak)}</div>
        </div>
        <div class="meta">${emoji} ${hemi} ‚Ä¢ ~${s.zhr}/hr</div>
      </div>
    `;
  }).join('');
}

/* =========================
   2) Canvas Starfield + Meteors
   ========================= */
const canvas = document.getElementById('sky');
const ctx = canvas.getContext('2d', { alpha: true });
let W,H, DPR = Math.min(2, window.devicePixelRatio||1);
function resize(){
  W = canvas.width = Math.floor(innerWidth * DPR);
  H = canvas.height = Math.floor(innerHeight * DPR);
  canvas.style.width = innerWidth+'px';
  canvas.style.height = innerHeight+'px';
}
resize(); addEventListener('resize', resize);

const stars = [];
const STAR_N = 200;
for (let i=0;i<STAR_N;i++){
  stars.push({
    x: Math.random()*W,
    y: Math.random()*H,
    r: (Math.random()*1.2+0.2)*DPR,
    a: Math.random()*0.6 + 0.3,
    tw: Math.random()*0.02 + 0.005
  });
}

let meteors = [];
function spawnMeteor(){
  const startX = -Math.random()*W*0.2;
  const startY = Math.random()*H*0.3;
  const len = Math.random()*200*DPR + 120*DPR;
  meteors.push({
    x: startX, y: startY, vx: 6*DPR, vy: 3*DPR, life: 0, len, maxLife: 1600 + Math.random()*1200
  });
}
setInterval(()=>{ if(Math.random()<0.25) spawnMeteor(); }, 2500);

function draw(){
  ctx.clearRect(0,0,W,H);
  for (const s of stars){
    s.a += s.tw*(Math.random()<0.5?-1:1);
    if (s.a<0.2) s.a=0.2; if (s.a>0.9) s.a=0.9;
    ctx.globalAlpha = s.a;
    ctx.fillStyle = '#cfe8ff';
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
    ctx.fill();
  }
  ctx.globalAlpha = 1;
  for (const m of meteors){
    m.x += m.vx; m.y += m.vy; m.life += 16;
    const grd = ctx.createLinearGradient(m.x, m.y, m.x-m.len, m.y-m.len*0.5);
    grd.addColorStop(0, 'rgba(255,255,255,0.9)');
    grd.addColorStop(1, 'rgba(124,198,255,0)');
    ctx.strokeStyle = grd;
    ctx.lineWidth = 2*DPR;
    ctx.beginPath();
    ctx.moveTo(m.x, m.y);
    ctx.lineTo(m.x - m.len, m.y - m.len*0.5);
    ctx.stroke();
  }
  meteors = meteors.filter(m => m.life < m.maxLife && m.x < W+200 && m.y < H+200);
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
